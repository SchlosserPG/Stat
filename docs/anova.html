<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probability And Business Statistics - 9&nbsp; Analysis of Variance (ANOVA)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./correlation.html" rel="next">
<link href="./ttests.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./anova.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Probability And Business Statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installing R and R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to R and RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataprep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Probability and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contingency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Contingency Tables and Chi-Squared</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ttests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hypothesis Testing with t-Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlation Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Linear Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Recommended Further Reading Materials</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance"><span class="header-section-number">9.0.1</span> At a Glance</a></li>
  <li><a href="#lesson-objectives" id="toc-lesson-objectives" class="nav-link" data-scroll-target="#lesson-objectives"><span class="header-section-number">9.0.2</span> Lesson Objectives</a></li>
  <li><a href="#consider-while-reading" id="toc-consider-while-reading" class="nav-link" data-scroll-target="#consider-while-reading"><span class="header-section-number">9.0.3</span> Consider While Reading</a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova"><span class="header-section-number">9.1</span> Analysis of Variance (ANOVA)</a>
  <ul class="collapse">
  <li><a href="#omnibus-test" id="toc-omnibus-test" class="nav-link" data-scroll-target="#omnibus-test"><span class="header-section-number">9.1.1</span> Omnibus test</a></li>
  <li><a href="#anova-methodology" id="toc-anova-methodology" class="nav-link" data-scroll-target="#anova-methodology"><span class="header-section-number">9.1.2</span> ANOVA Methodology</a></li>
  </ul></li>
  <li><a href="#type-i-and-type-ii-errors" id="toc-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#type-i-and-type-ii-errors"><span class="header-section-number">9.2</span> Type I and Type II Errors</a>
  <ul class="collapse">
  <li><a href="#some-reasons-for-error" id="toc-some-reasons-for-error" class="nav-link" data-scroll-target="#some-reasons-for-error"><span class="header-section-number">9.2.1</span> Some Reasons For Error</a></li>
  </ul></li>
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova"><span class="header-section-number">9.3</span> One-Way ANOVA</a>
  <ul class="collapse">
  <li><a href="#steps-for-conducting-a-one-way-anova" id="toc-steps-for-conducting-a-one-way-anova" class="nav-link" data-scroll-target="#steps-for-conducting-a-one-way-anova"><span class="header-section-number">9.3.1</span> Steps for Conducting a One-Way Anova</a></li>
  <li><a href="#statistics-in-a-one-way-anova-table" id="toc-statistics-in-a-one-way-anova-table" class="nav-link" data-scroll-target="#statistics-in-a-one-way-anova-table"><span class="header-section-number">9.3.2</span> Statistics in a One-Way ANOVA Table</a></li>
  <li><a href="#example-of-a-one-way-anova" id="toc-example-of-a-one-way-anova" class="nav-link" data-scroll-target="#example-of-a-one-way-anova"><span class="header-section-number">9.3.3</span> Example of a One-Way ANOVA</a></li>
  </ul></li>
  <li><a href="#two-way-anova" id="toc-two-way-anova" class="nav-link" data-scroll-target="#two-way-anova"><span class="header-section-number">9.4</span> Two-Way ANOVA</a>
  <ul class="collapse">
  <li><a href="#steps-for-conducting-a-two-way-anova" id="toc-steps-for-conducting-a-two-way-anova" class="nav-link" data-scroll-target="#steps-for-conducting-a-two-way-anova"><span class="header-section-number">9.4.1</span> Steps for Conducting a Two-Way ANOVA</a></li>
  <li><a href="#statistics-in-a-two-way-anova-table" id="toc-statistics-in-a-two-way-anova-table" class="nav-link" data-scroll-target="#statistics-in-a-two-way-anova-table"><span class="header-section-number">9.4.2</span> Statistics in a Two-Way ANOVA Table</a></li>
  <li><a href="#example-of-a-two-way-anova" id="toc-example-of-a-two-way-anova" class="nav-link" data-scroll-target="#example-of-a-two-way-anova"><span class="header-section-number">9.4.3</span> Example of a Two-way ANOVA</a></li>
  </ul></li>
  <li><a href="#choose-command" id="toc-choose-command" class="nav-link" data-scroll-target="#choose-command"><span class="header-section-number">9.5</span> choose() command</a></li>
  <li><a href="#using-ai" id="toc-using-ai" class="nav-link" data-scroll-target="#using-ai"><span class="header-section-number">9.6</span> Using AI</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">9.7</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ul>
<li>The main goal of this lesson is to understand and conduct one- and two-way ANOVAs and interpret their results. We will learn about Type I and Type II errors, which are applicable forms of error in any hypothesis test. We will also learn how to conduct post-hoc tests when an ANOVA yields significant results.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Project name: ANOVA</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Data used: congestion.csv and SAT.csv</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries used: tidyverse</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">####################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="at-a-glance" class="level3" data-number="9.0.1">
<h3 data-number="9.0.1" class="anchored" data-anchor-id="at-a-glance"><span class="header-section-number">9.0.1</span> At a Glance</h3>
<ul>
<li>In order to succeed in this section, you will need to apply what you learned about variable types (quantitative versus categorical) and hypothesis testing in earlier lessons We will learn how to conduct and interpret an ANOVA, which allows us to compare groups (from a categorical/factor variable) with respect to a continuous variable. Unlike the t-test that is limited to comparing two groups, the ANOVA is meant for three or more groups. We can also follow up a significant ANOVA with post-hoc tests to see which groups are different from each other in regards to the continuous variable.</li>
</ul>
</section>
<section id="lesson-objectives" class="level3" data-number="9.0.2">
<h3 data-number="9.0.2" class="anchored" data-anchor-id="lesson-objectives"><span class="header-section-number">9.0.2</span> Lesson Objectives</h3>
<ul>
<li>Conduct and interpret a one-way ANOVA.</li>
<li>Choose and use post-hoc tests and contrasts.</li>
<li>Conduct and interpret a two-way ANOVA.</li>
</ul>
</section>
<section id="consider-while-reading" class="level3" data-number="9.0.3">
<h3 data-number="9.0.3" class="anchored" data-anchor-id="consider-while-reading"><span class="header-section-number">9.0.3</span> Consider While Reading</h3>
<ul>
<li>In this lesson, we continue with our discussion of both hypothesis testing and using inference. However, we are no longer limiting ourselves to one or two populations. ANOVA consists of the calculations that provide information about levels of variability within a regression model and form a basis for calculating tests of significance. This means that ANOVA can be conducted as we will do here, and as part of a regression analysis.</li>
<li>ANOVA is used to determine if there are differences among three or more populations. In cases of only two groups, an independent samples t-test should be used as was discussed in an earlier lesson. When reading, be sure to make connections back to variable data type, and know that with ANOVA, we are testing for group differences where groups are the categorical X variable or variables, and we want to see if there are group differences in regards to a continuous/numerical Y.</li>
</ul>
</section>
<section id="analysis-of-variance-anova" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="analysis-of-variance-anova"><span class="header-section-number">9.1</span> Analysis of Variance (ANOVA)</h2>
<ul>
<li>An ANOVA is used to determine if there are differences among three or more groups. If there were only two groups, an independent samples t-test should be used.</li>
<li>In conducting an ANOVA, we utilize a completely randomized design, comparing sample means computed for each treatment to test whether the population means differ.</li>
<li>ANOVA has underlying assumptions to be met, and there are alternative methods to use when the assumptions are not met. The assumptions are extensions of those we use when comparing just two populations in a t.test:
<ul>
<li>The populations are normally distributed.</li>
<li>The population standard deviations are unknown but assumed equal.</li>
<li>Samples are selected independently from each population.</li>
</ul></li>
<li>Here we compare a total of <span class="math inline">\(k\)</span> populations, rather than just two. Therefore, the competing hypotheses for the one-way ANOVA:
<ul>
<li><span class="math inline">\(H_0: \mu_1 = \mu_2 = \cdots= \mu_k\)</span></li>
<li><span class="math inline">\(H_A:\)</span> Not all population means are equal</li>
</ul></li>
</ul>
<section id="omnibus-test" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="omnibus-test"><span class="header-section-number">9.1.1</span> Omnibus test</h3>
<ul>
<li>A significant result indicates the omnibus test is significant and that there is a difference between the means. This only suggests that there is at least one group difference somewhere between groups. This is not useful in determining which means are different from each other. Therefore, for the alternative hypothesis to be supported, at least one group must be different from the rest.</li>
<li>Then, if we find a significant omnibus test, we continue our analysis with planned contrasts and post-hoc tests, which determine which means are statistically significantly different from one another.</li>
</ul>
</section>
<section id="anova-methodology" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="anova-methodology"><span class="header-section-number">9.1.2</span> ANOVA Methodology</h3>
<ol type="1">
<li>We first compute the amount of variability between the sample means. This is known as the <em>between-treatments estimate</em>, which compares the sample means to the overall mean, sometimes called the grand mean, or the average pf all the values from the data set.</li>
<li>Then, we measure how much variability there is within each sample. This is known as the <em>within-treatments estimate</em>, which is essentially a measure of error.</li>
<li>A ratio of the first quantity to the second forms our test statistic which follows the <span class="math inline">\(F_{df1,df2}\)</span> distribution, where the degrees of freedom are calculated from the number of groups - 1 (<span class="math inline">\(df_1: k-1\)</span>) and the total number of observations minus the number of groups (<span class="math inline">\(df_2: n_t-k\)</span>).</li>
</ol>
<ul>
<li>Note an F distribution behaves differently than a z- or a t- distribution.
<ul>
<li>The z-distribution shows how many sample standard deviations (SD) some value is away from the mean.</li>
<li>The t-distribution shows how many standard errors (SE) away from the mean.</li>
<li>The F-distribution is used to compare 2 populations’ variances.</li>
</ul></li>
</ul>
</section>
</section>
<section id="type-i-and-type-ii-errors" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="type-i-and-type-ii-errors"><span class="header-section-number">9.2</span> Type I and Type II Errors</h2>
<ul>
<li><p>In any hypothesis test, including an ANOVA, it is important to acknowledge that there is error, and that it is possible to come up with the wrong conclusion. An important note is that we are calculating results and making conclusions based on probability calculated given the sample we have, the timing it was collected, and any biases that might have been used in designing and securing the data set. We could also be violating assumptions that make the findings less accurate if still accurate at all.<br>
</p></li>
<li><p>Therefore, it is really important to understand the limitations of what we are doing, and that there is always error! Our main goal as analysts is to minimize error as much as possible in selecting the right parameters, and having a data set that is as unbiased as possible so that the interpretation is as accurate as possible and consistent with the population it is inferring for.</p></li>
<li><p>There are 2 types of error:</p>
<ul>
<li>Type I Error: Committed when we reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is actually true. False Positive.
<ul>
<li>Occurs with probability <span class="math inline">\(\alpha\)</span>. <span class="math inline">\(\alpha\)</span> is chosen apriori.</li>
</ul></li>
<li>Type II Error: Committed when we do not reject <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_0\)</span> is actually false. False Negative.
<ul>
<li>Occurs with probability <span class="math inline">\(\beta\)</span>. Power of the Test = 1−<span class="math inline">\(\beta\)</span>.”For a given sample size <span class="math inline">\(n\)</span>, a decrease in <span class="math inline">\(\alpha\)</span> will increase <span class="math inline">\(\beta\)</span> and vice versa.”</li>
</ul></li>
</ul></li>
<li><p>Both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> decrease as <span class="math inline">\(n\)</span> increases. Therefore, an increase in sample size decreases these two types of error.</p></li>
<li><p>The two types of error can be mapped onto a hypothesis decision chart that shows the two decisions, reject <span class="math inline">\(H_0\)</span> or fail to reject <span class="math inline">\(H_0\)</span>, alongside what is actually happening in reality.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pictures/Ch7/Type1_2Error.png" title="Type I and Type II Error" class="img-fluid figure-img"></p>
<figcaption>Type I and Type II Error</figcaption>
</figure>
</div>
<ul>
<li><p>Consider the following example of competing hypotheses that relate to the court of law.</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: An accused person is innocent.</li>
<li><span class="math inline">\(H_A\)</span>: An accused person is guilty.</li>
</ul></li>
<li><p>Now, think through the consequences of making either a Type I and Type II error:</p>
<ul>
<li>Type I error (False Positive): Conclude that the accused is guilty when in reality, they are innocent.</li>
<li>Type II error (False Negative): Conclude that the accused is innocent when in reality, they are guilty.</li>
</ul></li>
</ul>
<p><img src="Pictures/Ch7/TypeErrorA.png" title="Type I and Type II Error" class="img-fluid" alt="Type I and Type II Error"> - Both types of error are extremely bad!</p>
<ul>
<li>In taking another example, let’s look at some sample results from a polygraph. A polygraph (lie detector) is an instrument used to determine if an individual is telling the truth. These tests are considered to be 89% reliable. In other words, if an individual lies, there is a 0.89 probability that the test will detect a lie. Let there also be a 0.10 probability that the test erroneously detects a lie even when the individual is actually telling the truth. Consider the null hypothesis, “the individual is telling the truth,” and look at all 4 options.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pictures/Ch7/TypeErrorB.png" title="Type I and Type II Error" class="img-fluid figure-img"></p>
<figcaption>Type I and Type II Error</figcaption>
</figure>
</div>
<ul>
<li><p>With the error conclusions from Type I and Type II error in this example, we either predicted that someone was being honest when they were telling a lie, or we called someone a liar that was telling the truth! Again, both are bad.</p></li>
<li><p>Now for a more recent example. Let’s look at the vaccine designed to prevent the spread of COVID-19. Again, we cannot assume the vaccine works without a significant test, so the alternative hypothesis <span class="math inline">\(H_A\)</span> is framed as against status quo, or that the vaccine does help.</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: Vaccine does not help prevent spread of COVID-19.</li>
<li><span class="math inline">\(H_A\)</span>: Vaccine does help prevent the spread of COVID-19.<br>
</li>
</ul></li>
<li><p>Now, think through the consequences of making either a Type I and Type II error and come to the fill out the 4 boxes like I did below.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pictures/Ch7/TypeErrorC.png" title="Type I and Type II Error" class="img-fluid figure-img"></p>
<figcaption>Type I and Type II Error</figcaption>
</figure>
</div>
<ul>
<li><p>In this scenario, if we made a Type I error, we would make people get vaccines that were not helpful. If we made a Type II error, we would end up not administering the vaccine when in fact it actually could help prevent the spread of COVID-19. In making the decision to give the vaccine, these types of errors were weighed (along with others) and the vaccine ended up being administered because the Type II error was considered more problematic than the Type I.</p></li>
<li><p>Some tests are designed to minimize Type I error, while others are designed to minimize Type II error. Selecting alpha levels that are smaller will help reduce Type I error, but at the cost of Type II error. And again, increasing sample size reduces both error.</p></li>
</ul>
<section id="some-reasons-for-error" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="some-reasons-for-error"><span class="header-section-number">9.2.1</span> Some Reasons For Error</h3>
<ul>
<li>Measurement error refers to the difference between a measured quantity and its true value which could be due to random error or systematic error.
<ul>
<li>Random error refers to naturally occurring errors that are to be expected.</li>
<li>Systematic error refers to miss-calibrated instruments causing error in measurement.</li>
</ul></li>
<li>Bias — the tendency of a sample statistic to systematically over- or underestimate a population parameter.
<ul>
<li>Selection bias refers to a systematic exclusion of certain groups from consideration for the sample.</li>
<li>Non-response bias refers to a systematic difference in preferences between respondents and non-respondents to a survey or a poll.</li>
<li>Social Desirability bias refers to a bias that refers to the systematic difference between a group’s “socially acceptable” responses to a survey or poll.</li>
</ul></li>
</ul>
</section>
</section>
<section id="one-way-anova" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="one-way-anova"><span class="header-section-number">9.3</span> One-Way ANOVA</h2>
<ul>
<li>One-way ANOVA compares population means based on one categorical variable.</li>
</ul>
<section id="steps-for-conducting-a-one-way-anova" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="steps-for-conducting-a-one-way-anova"><span class="header-section-number">9.3.1</span> Steps for Conducting a One-Way Anova</h3>
<ol type="1">
<li>Write the null and alternate hypotheses.</li>
<li>Compute the F-test statistic.</li>
<li>Compute the probability for the test statistic (p-value).</li>
<li>Interpret the probability.</li>
<li>Write a conclusion.</li>
<li>If model is significant, run post-hoc tests.</li>
</ol>
</section>
<section id="statistics-in-a-one-way-anova-table" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="statistics-in-a-one-way-anova-table"><span class="header-section-number">9.3.2</span> Statistics in a One-Way ANOVA Table</h3>
<ul>
<li>There are a number of statistics being calculated with an aov() command, with the goal of producing the F-test statistic, which corresponds to a p-value that we can interpret the same way as we did in the earlier lessons (p-value &lt; alpha = significant result - reject the <span class="math inline">\(H_0\)</span>).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pictures/Ch7/1WayANOVA.PNG" title="Formulas for One Way ANOVA" class="img-fluid figure-img"></p>
<figcaption>One Way ANOVA Formulas</figcaption>
</figure>
</div>
<section id="explained-variance" class="level4" data-number="9.3.2.1">
<h4 data-number="9.3.2.1" class="anchored" data-anchor-id="explained-variance"><span class="header-section-number">9.3.2.1</span> Explained Variance</h4>
<ul>
<li><p>In a one-way ANOVA, first, we compute the <em>explained variance</em>, which in a one-way ANOVA is the sum of squares due to treatments (SSTR), where the treatment is our grouping variable. The explained variance suggests that the variation in outcome can be explained by a model, or in our case, a grouping variable. In computing the SSTR, we square the deviation between each group mean (<span class="math inline">\(\bar{y}_j\)</span>) and the grand mean <span class="math inline">\(\bar{y}\)</span> and multiply it by the sample size (<span class="math inline">\(n_j\)</span>) and sum up all the values <span class="math inline">\(\sum\)</span>. This leads to the following formula:</p>
<ul>
<li><span class="math inline">\(SSTR = \sum{n_j*(\bar{y}_j-\bar{y}) ^2}\)</span></li>
</ul></li>
<li><p>Degrees of freedom for the SSTR are computed by the number of groups <span class="math inline">\((k-1)\)</span>.</p>
<ul>
<li><span class="math inline">\(df_{sstr} = k-1\)</span></li>
</ul></li>
<li><p>The mean square due to treatment (MSTR) takes the value for the SSTR and divides by the treatment’s degrees of freedom <span class="math inline">\((k-1)\)</span>.</p>
<ul>
<li><span class="math inline">\(MSTR = SSTR/(k-1)\)</span></li>
</ul></li>
<li><p>Above in the overall methodology, the MSTR corresponds to the <em>between-treatments estimate</em>.</p></li>
</ul>
</section>
<section id="unexplained-variance" class="level4" data-number="9.3.2.2">
<h4 data-number="9.3.2.2" class="anchored" data-anchor-id="unexplained-variance"><span class="header-section-number">9.3.2.2</span> Unexplained Variance</h4>
<ul>
<li><p>There is also a measure of <em>unexplained variance</em>, which we term error. In a one-way ANOVA, this unexplained variance refers to variability in the outcome that is not explained by the grouping variable. In the table, this error is called the sum of squares error (SSE). SSE is calculated by first multiplying the sample size of group and subtracting one (<span class="math inline">\(n_j-1\)</span>), and then multiplying that number by its group variance (<span class="math inline">\(\sigma^2_i\)</span>). Once all groups are calculated, we add it up (<span class="math inline">\(\sum\)</span>). This leads to the following formula:</p>
<ul>
<li><span class="math inline">\(SSE = \sum^k_{j=1}{(n_j-1)*\sigma^2_j}\)</span></li>
</ul></li>
<li><p>This formula above considers the formula and definition of variance (<span class="math inline">\(\sigma^2\)</span>) and simplifies the formula, which you can also use:</p>
<ul>
<li><span class="math inline">\(SSE = \sum^k_{j=1}\sum^n_{i=1}(y_{ij}-\bar{y_j})^2/(n-k)\)</span></li>
</ul></li>
<li><p>Degrees of freedom for the SSE are computed by taking the total number of observations (<span class="math inline">\(n_t\)</span>) and subtracting the number of groups <span class="math inline">\((k)\)</span>.</p>
<ul>
<li><span class="math inline">\(df_{sse} = n_t-k\)</span></li>
</ul></li>
<li><p>The mean square due to error (MSE) takes the SSE and divides by the appropriate degrees of freedom (<span class="math inline">\(n_t-k\)</span>).</p>
<ul>
<li><span class="math inline">\(MSE = SSE/(n_t-k)\)</span></li>
</ul></li>
<li><p>Above in the overall methodology, the MSE corresponds to the <em>within-treatments estimate</em>.</p></li>
<li><p>There is a total sum of squares (SST) being calculated in an ANOVA, which refers to the total variance (explained and unexplained). This value is calculated as the total number of observations minus 1 (<span class="math inline">\(n_t-1\)</span>). We don’t see it explicitly in our R output, but it is needed to help understand the full model.</p></li>
</ul>
</section>
<section id="calculating-f" class="level4" data-number="9.3.2.3">
<h4 data-number="9.3.2.3" class="anchored" data-anchor-id="calculating-f"><span class="header-section-number">9.3.2.3</span> Calculating F</h4>
<ul>
<li>Finally, to calculate the F-test statistic, we take the MSTR (explained variability) and divide by the MSE (unexplained variability) considering the appropriate degrees of freedom (<span class="math inline">\(k-1\)</span> and <span class="math inline">\(n_t-k\)</span>).</li>
<li>A p-value is computed from that statistic mathematically by using the correct command in R.
<ul>
<li><span class="math inline">\(F_{k-1,n_t-k} = MSTR/MSE\)</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="example-of-a-one-way-anova" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="example-of-a-one-way-anova"><span class="header-section-number">9.3.3</span> Example of a One-Way ANOVA</h3>
<ul>
<li>Like the t-test, a one-way ANOVA follows 5 steps, and then includes an optional 6th step after significance is found and confirmed in step 5.</li>
</ul>
<section id="step-1-set-up-null-and-alternative-hypothesis" class="level4" data-number="9.3.3.1">
<h4 data-number="9.3.3.1" class="anchored" data-anchor-id="step-1-set-up-null-and-alternative-hypothesis"><span class="header-section-number">9.3.3.1</span> Step 1: Set Up Null and Alternative Hypothesis</h4>
<ul>
<li>The competing hypotheses for the one-way ANOVA:
<ul>
<li><span class="math inline">\(H_0: \mu_{Atlanta} = \mu_{Houston}= \mu_{LosAngeles} = \mu_{SanFran} = \mu_{DC}\)</span></li>
<li><span class="math inline">\(H_A:\)</span> Not all population means of congestion levels are equal among the cities</li>
</ul></li>
</ul>
</section>
<section id="steps-2-and-3-compute-the-f-test-statistic-and-p-value" class="level4" data-number="9.3.3.2">
<h4 data-number="9.3.3.2" class="anchored" data-anchor-id="steps-2-and-3-compute-the-f-test-statistic-and-p-value"><span class="header-section-number">9.3.3.2</span> Steps 2 and 3: Compute the F-test Statistic and p-Value</h4>
<ul>
<li><p>First, we read in the data set and give a look at what is included.</p>
<ul>
<li>Because we are using read.csv() command, we can set stringsAsFactors argument to TRUE so that the categorical variable will be coded appropriately upon download.</li>
<li>The summary() command suggests that there is one categorical variable, “City” and one continuous variable, “CongestionRating.”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>congestionData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/congestion.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(congestionData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             City    CongestionRating
 Atlanta       :25   Min.   :44.00   
 Houston       :25   1st Qu.:56.00   
 Los Angeles   :25   Median :59.00   
 San Francisco :25   Mean   :60.06   
 Washington, DC:25   3rd Qu.:64.00   
                     Max.   :77.00   </code></pre>
</div>
</div></li>
<li><p>We use the aov() command for one-way and later on for a two-way ANOVA.</p>
<ul>
<li>In either command, our formula is ContinuousVariable ~ CategoricalVariable - this will allow us to see if there are group differences in CongestionRating (<em>continuous</em>) based on city (<em>categorical</em>).</li>
<li>Take a good look at the output from these commands to compare the results.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A common set of commands that work for both a one-way and two-way</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA: aov() command with output in a followup command: either</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># anova() or summary() command.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Anova1way <span class="ot">&lt;-</span> <span class="fu">aov</span>(CongestionRating <span class="sc">~</span> City, <span class="at">data =</span> congestionData)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Anova1way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
City          4   3251   812.7   37.25 &lt;2e-16 ***
Residuals   120   2618    21.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anova() command works exactly the same as summary here.  This</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># command is very prevalent in various textbooks and online</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tutorials.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Anova1way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: CongestionRating
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
City        4 3250.7  812.67  37.251 &lt; 2.2e-16 ***
Residuals 120 2617.9   21.82                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Using the anova() or summary() commands, we can see the results from the ANOVA table, including the degrees of freedom (Df), sum of squares (Sum Sq), mean square (Mean Sq), F-test statistic (F value) and p-value (Pr(&gt;F)). It also includes asterisks (*) symbols if there are group differences due to our categorical variable. The more asterisks you see, the smaller the significant code. There is a table for these codes within the output marked <em>Signif. codes</em>.</li>
<li>Reading the codes:
<ul>
<li>If there are three asterisks, you would say that that your p-value is less than .001. If there are 2, your p-value is less than .01. 1 asterisk indicates a p-value &lt; .05.</li>
<li>We never say our p-value is 0, but instead say it is less than ___.</li>
<li>We <em>do not</em> use .1 as a significance level, although some statisticians mark a p-value less than .1 as “marginally significant”. There is a big debate about this, but I agree with the general consensus, so our threshold for this class is less than .05. Anything greater than or equal to .05 is not significant.</li>
</ul></li>
</ul>
</section>
<section id="steps-4-and-5-interpret-the-probability-and-write-a-conclusion." class="level4" data-number="9.3.3.3">
<h4 data-number="9.3.3.3" class="anchored" data-anchor-id="steps-4-and-5-interpret-the-probability-and-write-a-conclusion."><span class="header-section-number">9.3.3.3</span> Steps 4 and 5: Interpret the Probability and Write a conclusion.</h4>
<ul>
<li>The F-test statistic is 37.251 and the p-value is &lt; 2.2e-16 ***. This p-value is &lt; all typical alpha values like .05 or .001. This value is very close to 0. We would state that our p-value is less than .001 by looking at the table and noting the three asterisks.<br>
</li>
<li>The p-value result suggests that we support the alternative <span class="math inline">\(H_A\)</span>: Not all population means are equal.</li>
<li>More specifically we reject the null hypothesis <span class="math inline">\(H_0\)</span> in support of <span class="math inline">\(H_A\)</span> and conclude that not all congestion levels are equal among the cities.</li>
</ul>
</section>
<section id="step-6-if-model-is-significant-run-post-hoc-tests" class="level4" data-number="9.3.3.4">
<h4 data-number="9.3.3.4" class="anchored" data-anchor-id="step-6-if-model-is-significant-run-post-hoc-tests"><span class="header-section-number">9.3.3.4</span> Step 6: If Model is Significant, Run Post-Hoc Tests</h4>
<ul>
<li>Pairwise comparisons: There are many tests to compute pairwise comparisons. The tests tend to vary in whether they minimize Type I or Type II error, and by how much. Many of the tests change the distribution in the calculation to alter the final results. We go over the following methods:
<ol type="1">
<li>Bonferroni Method;</li>
<li>TukeyHSD Method</li>
</ol></li>
</ul>
<section id="bonferroni-method" class="level5" data-number="9.3.3.4.1">
<h5 data-number="9.3.3.4.1" class="anchored" data-anchor-id="bonferroni-method"><span class="header-section-number">9.3.3.4.1</span> Bonferroni Method</h5>
<ul>
<li>The Bonferroni method is a pairwise post-hoc test that is used after finding a statistically significant ANOVA. This method conducts a t-test for each pair of means and adjusts the threshold for statistical significance to ensure that there is a small enough risk of Type I error; it is generally considered a very conservative post hoc test that only identifies the largest differences between means as statistically significant.</li>
<li>The function has several arguments, such as <span class="math inline">\(x =\)</span> for the continuous variable (listed first); <span class="math inline">\(g =\)</span> for the grouping or categorical variable (listed 2nd); and the p-value adjustment, <span class="math inline">\(p.adj =\)</span>, which can be set as __bonf_ for Bonferroni (listed 3rd).</li>
<li>The output is a matrix of p-values, testing each pair for group differences. A value &lt; alpha signifies significant group differences.
<ul>
<li>Based on the output, there are no differences in congestion levels between Houston and Atlanta, San Francisco and Atlanta, and Houston and San Francisco.</li>
<li>There are group differences in congestion levels between all other remaining groups (p-value &lt; alpha).</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(congestionData<span class="sc">$</span>CongestionRating, congestionData<span class="sc">$</span>City, <span class="at">p.adj =</span> <span class="st">"bonf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  congestionData$CongestionRating and congestionData$City 

               Atlanta Houston Los Angeles San Francisco
Houston        1.00000 -       -           -            
Los Angeles    9.7e-15 1.3e-15 -           -            
San Francisco  1.00000 1.00000 &lt; 2e-16     -            
Washington, DC 0.00269 0.00071 2.1e-06     3.8e-05      

P value adjustment method: bonferroni </code></pre>
</div>
</div>
</section>
<section id="tukey-hsd-method" class="level5" data-number="9.3.3.4.2">
<h5 data-number="9.3.3.4.2" class="anchored" data-anchor-id="tukey-hsd-method"><span class="header-section-number">9.3.3.4.2</span> Tukey HSD Method</h5>
<ul>
<li>The Tukey HSD method is another pairwise post-hoc test that is used after finding a statistically significant ANOVA. This method is used to determine which means are statistically significantly different from each other by comparing each pair of means. This method is less conservative than the Bonferroni post hoc test.</li>
<li>This test is modified from the Bonferroni test using a q-distribution instead of a t-distribution to calculate the answers.</li>
<li>Using the TukeyHSD() command, we can use the Anova1way object because we already used the aov() command to produce our model above This aov() command is required before or while running the TukeyHSD() command.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(Anova1way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = CongestionRating ~ City, data = congestionData)

$City
                               diff        lwr        upr     p adj
Houston-Atlanta               -0.48  -4.139015   3.179015 0.9962320
Los Angeles-Atlanta           12.24   8.580985  15.899015 0.0000000
San Francisco-Atlanta         -1.44  -5.099015   2.219015 0.8113836
Washington, DC-Atlanta         4.96   1.300985   8.619015 0.0024588
Los Angeles-Houston           12.72   9.060985  16.379015 0.0000000
San Francisco-Houston         -0.96  -4.619015   2.699015 0.9499289
Washington, DC-Houston         5.44   1.780985   9.099015 0.0006646
San Francisco-Los Angeles    -13.68 -17.339015 -10.020985 0.0000000
Washington, DC-Los Angeles    -7.28 -10.939015  -3.620985 0.0000021
Washington, DC-San Francisco   6.40   2.740985  10.059015 0.0000373</code></pre>
</div>
</div>
<ul>
<li><p>Based on the output, we find similar results to the Bonferroni test. There are no differences in congestion levels between Houston and Atlanta, San Francisco and Atlanta, and Houston and San Francisco. There are group differences in congestion levels between all other remaining groups (p-value &lt; alpha).</p></li>
<li><p>With the TukeyHSD() command, we can also determine which group mean is higher than the other by looking at the “diff” score. If you see a negative score than the second group listed in the output is higher than the first group listed. Ignoring the insignificant p-values &gt; .05, we find that both San Francisco and Washington has significantly less congestion than Los Angeles. We find that Los Angeles and Washington have a significantly higher group mean than Atlanta. Los Angeles and Washington DC also have a significantly higher group mean than Houston. Finally, Washington DC has a significantly higher group mean than San Francisco.</p></li>
</ul>
</section>
</section>
</section>
</section>
<section id="two-way-anova" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="two-way-anova"><span class="header-section-number">9.4</span> Two-Way ANOVA</h2>
<ul>
<li>A two-way ANOVA is called a randomized block design.</li>
<li>The term “block” refers to a matched set of observations across the treatments.</li>
<li>In a two-way ANOVA, there are now three sources of variation:
<ul>
<li>Row variability (due to blocks or Factor B or a first grouping variable),</li>
<li>Column variability (due to treatments or Factor A or a second grouping variable), and,</li>
<li>Variability due to chance or SSE.</li>
</ul></li>
<li>In altering the methodology above, the row and column variability take place of the <em>between-treatment estimate</em> listed above, which still corresponds to <em>explained variance</em>. We still have one <em>within-treatment estimate</em> as before, or a measure of <em>unexplained variance</em>.</li>
</ul>
<section id="steps-for-conducting-a-two-way-anova" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="steps-for-conducting-a-two-way-anova"><span class="header-section-number">9.4.1</span> Steps for Conducting a Two-Way ANOVA</h3>
<ol type="1">
<li>Write the null and alternate hypotheses for each grouping variable.</li>
<li>Compute the F-test statistics for each grouping variable.</li>
<li>Compute the probability for the test statistics (2 p-values for a 2-way ANOVA).</li>
<li>Interpret the probabilities.</li>
<li>Write a conclusion.</li>
<li>If model is significant, run post-hoc tests.</li>
</ol>
<ul>
<li>The steps are the same as a one-way ANOVA listed above, with the exception that now we have 2 grouping variables, so we need 2 F-stats and 2 p-values.</li>
</ul>
</section>
<section id="statistics-in-a-two-way-anova-table" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="statistics-in-a-two-way-anova-table"><span class="header-section-number">9.4.2</span> Statistics in a Two-Way ANOVA Table</h3>
<ul>
<li>We add another row to our ANOVA table when we move from a one-way ANOVA to a two-way ANOVA. The goal is the same, which is to produce a F-test statistic. In a two-way ANOVA, we will have two F-test statistics (one for each grouping variable). Each F-test statistic corresponds to a separate p-value that we can interpret the same way as we did in the last lessons (p-value &lt; alpha = significant result - reject the <span class="math inline">\(H_0\)</span>). So we can find one group significant and not the other, neither significant, or both significant with one test.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Pictures/Ch7/2WayANOVA.PNG" title="Formulas for Two Way ANOVA" class="img-fluid figure-img"></p>
<figcaption>Two Way ANOVA Formulas</figcaption>
</figure>
</div>
<section id="explained-variance-1" class="level4" data-number="9.4.2.1">
<h4 data-number="9.4.2.1" class="anchored" data-anchor-id="explained-variance-1"><span class="header-section-number">9.4.2.1</span> Explained Variance</h4>
<ul>
<li><p>In a two-way ANOVA, we still start by computing the <em>explained variance</em>. Since we have an additional grouping variable, or factor, we will have two sum of squares measures, a sum of squares for factor A (SSA) and a sum of squares for factor B (SSB). Factor B is typically called a row (r) factor, while Factor A is typically called a column (c) factor. However, the order of the output will depend on the order of your formula in R.</p></li>
<li><p>The explained variance still suggests that the variation in outcome can be explained by a model, but now it will be due to the two grouping variables. In computing the SSB, we take the number of columns (<span class="math inline">\(c\)</span>) and we multiply by the sum of the squared deviation between each group B mean (<span class="math inline">\(\bar{y_j}\)</span>) and the grand mean <span class="math inline">\(\bar{y}\)</span>.</p>
<ul>
<li><span class="math inline">\(SSB = c*\sum^r_{j=1}{(\bar{y_j}-\bar{y}) ^2}\)</span></li>
</ul></li>
<li><p>In computing SSA, we take the number of rows and we multiply that number by the sum of the squared deviation between each group A mean and the grand mean</p>
<ul>
<li><span class="math inline">\(SSA =r*\sum^c_{i=1}{(\bar{y_i}-\bar{y}) ^2}\)</span></li>
</ul></li>
<li><p>Degrees of freedom for the SSB are computed by the number of rows - 1 <span class="math inline">\((r-1)\)</span>, and the degrees of freedom for SSA are computed as the number of columns - 1 <span class="math inline">\((c-1)\)</span>.</p>
<ul>
<li><span class="math inline">\(df_{ssb} = r-1\)</span></li>
<li><span class="math inline">\(df_{ssa} = c-1\)</span></li>
</ul></li>
<li><p>The mean square due to Factor B (MSB) and Factor A (MSA) both take the value from the appropriate sum of squares (SSB and SSA) and divides that factors degrees of freedom <span class="math inline">\((r-1)\)</span> or <span class="math inline">\((c-1)\)</span>.</p>
<ul>
<li><span class="math inline">\(MSB = SSB/(r-1)\)</span></li>
<li><span class="math inline">\(MSA = SSA/(c-1)\)</span></li>
</ul></li>
</ul>
</section>
<section id="unexplained-variance-1" class="level4" data-number="9.4.2.2">
<h4 data-number="9.4.2.2" class="anchored" data-anchor-id="unexplained-variance-1"><span class="header-section-number">9.4.2.2</span> Unexplained Variance</h4>
<ul>
<li><p>In a two-way ANOVA, there is still only one measure of <em>unexplained variance</em>, which we term residual error.</p></li>
<li><p>The SSE is calculated after deriving the total variance (SST = both explained and unexplained), and subtracting the explained variance (SSB and SSA).</p>
<ul>
<li><span class="math inline">\(SSE = SST - (SSA + SSB)\)</span></li>
</ul></li>
<li><p>Degrees of freedom for the SSE are computed by taking the total number of observations (<span class="math inline">\(n_t\)</span>) and subtracting the number of rows (r) and the number of columns (c) and adding 1 <span class="math inline">\((n_t-c-r+1)\)</span>.</p>
<ul>
<li><span class="math inline">\(df_{sse} = n_t-c-r+1\)</span></li>
</ul></li>
<li><p>The mean square due to error (MSE) takes the SSE and divides by the appropriate degrees of freedom <span class="math inline">\((n_t-c-r+1)\)</span>.</p>
<ul>
<li><span class="math inline">\(MSE = SSE/(n_t-c-r+1)\)</span></li>
</ul></li>
<li><p>There is a total sum of squares (SST) being calculated mentioned above, which again refers to the total variance (explained and unexplained). To get this calculation, we take the squared deviation between each observation and the grand mean and we sum up all of our values.</p></li>
<li><p>There is also a total degrees of freedom in a two-way ANOVA, which is the total number of observations minus 1 (<span class="math inline">\(n_t-1\)</span>). We don’t see it explicitly in our R output, but it is needed to help understand the full model.</p></li>
</ul>
</section>
<section id="calculating-f-test-statistics" class="level4" data-number="9.4.2.3">
<h4 data-number="9.4.2.3" class="anchored" data-anchor-id="calculating-f-test-statistics"><span class="header-section-number">9.4.2.3</span> Calculating F-test Statistics</h4>
<ul>
<li>Finally, to calculate the 2 F-test statistics, given a two-way ANOVA, we take both the MSB (explained variability for factor B) and the MSA (explained variability for factor A) and divide both by the MSE (unexplained variability) considering the appropriate degrees of freedom (<span class="math inline">\(c-1\)</span> and <span class="math inline">\(r-1\)</span> and <span class="math inline">\(n_t-c-r+1\)</span>).</li>
<li>This gives us two scores to evaluate. A p-value is computed from each F-test statistic mathematically by using the correct command in R.
<ul>
<li><span class="math inline">\(F1_{c-1,n_t-c-r+1 }= MSB/MSE\)</span></li>
<li><span class="math inline">\(F2_{r-1,n_t-c-r+1 }= MSA/MSE\)</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="example-of-a-two-way-anova" class="level3" data-number="9.4.3">
<h3 data-number="9.4.3" class="anchored" data-anchor-id="example-of-a-two-way-anova"><span class="header-section-number">9.4.3</span> Example of a Two-way ANOVA</h3>
<ul>
<li>Let’s run an example to compare SAT scores to see if they are comparable from different instructors {Instructor 1, 2, and 3} and across 4 races {Asian.American, Black, Mexican.American, and White}.</li>
</ul>
<section id="step-1-set-up-null-and-alternative-hypothesis-1" class="level4" data-number="9.4.3.1">
<h4 data-number="9.4.3.1" class="anchored" data-anchor-id="step-1-set-up-null-and-alternative-hypothesis-1"><span class="header-section-number">9.4.3.1</span> Step 1: Set Up Null and Alternative Hypothesis</h4>
<ul>
<li><p>The competing hypotheses for the two-way ANOVA are two-fold:</p></li>
<li><p>Hypothesis 1:</p>
<ul>
<li><span class="math inline">\(H_0: \mu_{Instructor1} = \mu_{Instructor2}= \mu_{Instructor3}\)</span></li>
<li><span class="math inline">\(H_A:\)</span> Not all population means of SAT scores are equal among the instructors</li>
</ul></li>
<li><p>Hypothesis 2:</p>
<ul>
<li><span class="math inline">\(H_0: \mu_{Asian.American} = \mu_{Black} = \mu_{Mexical.American} =  \mu_{White}\)</span></li>
<li><span class="math inline">\(H_A:\)</span> Not all population means of SAT scores are equal among races</li>
</ul></li>
</ul>
</section>
<section id="steps-2-and-3-compute-the-f-test-statistics-and-p-values" class="level4" data-number="9.4.3.2">
<h4 data-number="9.4.3.2" class="anchored" data-anchor-id="steps-2-and-3-compute-the-f-test-statistics-and-p-values"><span class="header-section-number">9.4.3.2</span> Steps 2 and 3: Compute the F-test Statistics and p-Values</h4>
<ul>
<li><p>Like a one-way ANOVA, in a two-way ANOVA, we start with an appropriate data set.</p>
<ul>
<li>Again, because we are using read.csv() command, we can set stringsAsFactors argument to TRUE so that the categorical variable will be coded appropriately upon download.</li>
<li>The summary() command suggests that there are two categorical variables, “Instructor” and “Race”, and one continuous variable, “SAT.”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>SATdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/SAT.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SATdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Instructor               Race         SAT      
 Instructor A:40   Asian.American  :30   Min.   :1190  
 Instructor B:40   Black           :30   1st Qu.:1328  
 Instructor C:40   Mexican.American:30   Median :1492  
                   White           :30   Mean   :1468  
                                         3rd Qu.:1592  
                                         Max.   :1772  </code></pre>
</div>
</div></li>
</ul>
</section>
<section id="steps-4-and-5-interpret-the-probabilities-and-write-a-conclusion" class="level4" data-number="9.4.3.3">
<h4 data-number="9.4.3.3" class="anchored" data-anchor-id="steps-4-and-5-interpret-the-probabilities-and-write-a-conclusion"><span class="header-section-number">9.4.3.3</span> Steps 4 and 5: Interpret the Probabilities and Write a Conclusion</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Anova2way <span class="ot">&lt;-</span> <span class="fu">aov</span>(SAT <span class="sc">~</span> Instructor <span class="sc">+</span> Race, <span class="at">data =</span> SATdata)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Anova2way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df  Sum Sq Mean Sq F value Pr(&gt;F)    
Instructor    2    5932    2966   1.084  0.342    
Race          3 2353300  784433 286.624 &lt;2e-16 ***
Residuals   114  311995    2737                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>In the ANOVA results, we find that there was no difference in SAT score based on the Instructor of record. Specifically, we find a F-test statistic of 1.084 and an associated p-value at .342. That p-value is &gt; alpha (.05), and therefore, we fail to reject the null hypothesis <span class="math inline">\((H_0:  \mu_{Instructor1} = \mu_{Instructor2}= \mu_{Instructor3})\)</span>.</p></li>
<li><p>We also find that Race is significant, with a F-test statistic of 286.624 and an associated p-value of &lt;2e-16 ***. This means that we can reject the null hypothesis and support the alternative hypothesis (<span class="math inline">\(H_A:\)</span> Not all population means of SAT scores are equal among races).</p></li>
<li><p>This means that we can conduct post-hoc tests on our Race variable. If we conduct any post-hoc tests on Instructor, we should find no differences in groups (which we already found in the ANOVA results above). This means additional testing the Instructor variable is an unnecessary step.</p></li>
</ul>
</section>
<section id="step-6-if-model-is-significant-run-post-hoc-tests-1" class="level4" data-number="9.4.3.4">
<h4 data-number="9.4.3.4" class="anchored" data-anchor-id="step-6-if-model-is-significant-run-post-hoc-tests-1"><span class="header-section-number">9.4.3.4</span> Step 6: If Model is Significant, Run Post-Hoc Tests</h4>
<ul>
<li>Using the pairwise.t.test() command, we can run a Bonferroni test on just race by using the command below. This result suggest that there are group differences between all groups. We can tell that because all p-values are less than alpha at .05.<br>
</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(SATdata<span class="sc">$</span>SAT, SATdata<span class="sc">$</span>Race, <span class="at">p.adj =</span> <span class="st">"bonf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  SATdata$SAT and SATdata$Race 

                 Asian.American Black   Mexican.American
Black            &lt; 2e-16        -       -               
Mexican.American &lt; 2e-16        4.9e-09 -               
White            0.0044         &lt; 2e-16 &lt; 2e-16         

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<ul>
<li>Using the TukeyHSD() Method, we do receive output for both Race and Instructor. As expected, all p-values under the instructor grouping are well above an alpha of .05, meaning not significant (Fail to reject <span class="math inline">\(H_0\)</span>).</li>
<li>Receiving similar results to the Bonferroni test with regards to Race, we find all group differences significant. Specifically, Black Americans, Mexican Americans, and White Americans scored lower on their SAT than Asian Americans. Mexican Americans and White Americans scored higher on their SAT than Black Americans. White Americans scored higher than Mexican Americans. Using this command, we can tell which group scored lower than the other by looking at the difference score “diff”.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(Anova2way)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = SAT ~ Instructor + Race, data = SATdata)

$Instructor
                             diff       lwr      upr     p adj
Instructor B-Instructor A  -0.275 -28.05409 27.50409 0.9996954
Instructor C-Instructor A -15.050 -42.82909 12.72909 0.4056475
Instructor C-Instructor B -14.775 -42.55409 13.00409 0.4189723

$Race
                                      diff        lwr        upr     p adj
Black-Asian.American            -339.33333 -374.55195 -304.11472 0.0000000
Mexican.American-Asian.American -248.86667 -284.08528 -213.64805 0.0000000
White-Asian.American             -46.90000  -82.11862  -11.68138 0.0040188
Mexican.American-Black            90.46667   55.24805  125.68528 0.0000000
White-Black                      292.43333  257.21472  327.65195 0.0000000
White-Mexican.American           201.96667  166.74805  237.18528 0.0000000</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="choose-command" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="choose-command"><span class="header-section-number">9.5</span> choose() command</h2>
<ul>
<li>The Combination function counts the number of ways to choose objects from a total of objects. The order in which the objects are listed does not matter.</li>
<li>Since repetition is not allowed, we use <span class="math inline">\(C(n,x) = (n)!/((n-x!)*x!)\)</span></li>
<li>In post hoc tests, x is always 2.</li>
<li>you can calculate the factorial of a number using the factorial function in base R.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># C(4,2) = 4!/2!*(4-2)! manually</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">/</span>((<span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with the factorial function</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">factorial</span>(<span class="dv">4</span>)<span class="sc">/</span>(<span class="fu">factorial</span>(<span class="dv">4</span> <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">factorial</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<ul>
<li>A quick check on how many pairs we can expect in our post-hoc output, we can use the choose() command. We always only check 2 groups at a time, so the 2nd argument should remain a 2.</li>
<li>If we have 4 races, we would use 4,2 inside the command as shown below. This means we should see 6 p-value statistics for 6 pairwise tests.<br>
</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with choose function</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">4</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<ul>
<li>We had 3 instructors, so we would use 3,2 inside the command as shown below. If this variable was significant, we should see 3 p-value statistics for 3 pairwise tests.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section>
<section id="using-ai" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="using-ai"><span class="header-section-number">9.6</span> Using AI</h2>
<ul>
<li><p>Use the following prompt on a generative AI, like chatGPT to learn more about ANOVA analysis.</p>
<ul>
<li>Conduct an ANOVA test to compare group means. Use the aov() and anova() functions for ANOVA. Discuss the F-statistic and p-value, and what they indicate about the differences between group means.</li>
</ul></li>
</ul>
</section>
<section id="summary" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">9.7</span> Summary</h2>
<ul>
<li>In this section, we learned about Type I and Type II error and the importance of reducing both. We also learned about a one-way ANOVA and a two-way ANOVA, including how to conduct them, and when to evaluate post-hoc tests.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ttests.html" class="pagination-link" aria-label="Hypothesis Testing with t-Tests">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Hypothesis Testing with t-Tests</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./correlation.html" class="pagination-link" aria-label="Correlation Analysis">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlation Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>